<!DOCTYPE html>
<html lang="en">

<head>
  <title>Header - Underdark CSS</title>
  <meta charset="UTF-8">
  <title>µWeb3 framework</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/static/css/base.css">
  <link rel="stylesheet" href="/static/css/layout.css">
  <link rel="stylesheet" href="/static/css/module.css">
  <link rel="stylesheet" href="/static/css/theme.css">
</head>

<body id="header" class="layout">
  <header>
    <div>
      <div class="logo">
        <a href="/">µWeb3 framework</a>
        <p>A lightweight, high performance python web framework.</p>
      </div>
      {{inline nav.html}}
      <button class="toggle">Toggle</button>
    </div>
  </header>
  <main>
    <aside>
      <section>
        <h2>Documentation</h2>
        <nav>
          {{inline documentation/side-nav.html}}
      </section>
    </aside>
    <div>
      <section>
        <h2>Routing</h2>

        <div id="routing_explained">
          <h3>Routing explained [outdated]</h3>
          <p>
            When a request is sent to µWeb, the first thing that needs to be made is the decision where and how to handle it. 
            The request router is the place where this happens. 
            The router employed in µWeb is based on regular expressions, 
            and delegates the request to the handler associated with the first matching expression.
          </p>
          <p>
            Before we explain everything there is know about routes and handlers, 
            an example of how a router would look. 
            The example given is a very stripped down version of the handler from the uweb_info example project:
          </p>
<pre><code class="python syntaxhl"><span class="CodeRay"><span class="line-numbers"> 1</span><span class="keyword">import</span> <span class="include">uweb3</span>
<span class="line-numbers"> 2</span><span class="keyword">from</span> <span class="include">uweb3.uweb_info</span> <span class="keyword">import</span> <span class="include">pages</span>
<span class="line-numbers"> 3</span>
<span class="line-numbers"> 4</span>PAGE_CLASS = pages.PageMaker
<span class="line-numbers"> 5</span>ROUTES = (
<span class="line-numbers"> 6</span>    (<span class="string"><span class="delimiter">'</span><span class="content">/static/(.*)</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Static</span><span class="delimiter">'</span></span>),
<span class="line-numbers"> 7</span>    (<span class="string"><span class="delimiter">'</span><span class="content">/(broken.*)</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">FourOhFour</span><span class="delimiter">'</span></span>),
<span class="line-numbers"> 8</span>    (<span class="string"><span class="delimiter">'</span><span class="content">/haltandcatchfire</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">MakeFail</span><span class="delimiter">'</span></span>),
<span class="line-numbers"> 9</span>    (<span class="string"><span class="delimiter">'</span><span class="content">/json</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Json</span><span class="delimiter">'</span></span>),
<span class="line-numbers"><strong>10</strong></span>    (<span class="string"><span class="delimiter">'</span><span class="content">/text</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Text</span><span class="delimiter">'</span></span>),
<span class="line-numbers">11</span>    (<span class="string"><span class="delimiter">'</span><span class="content">/redirect/(.*)</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Redirect</span><span class="delimiter">'</span></span>),
<span class="line-numbers">12</span>    (<span class="string"><span class="delimiter">'</span><span class="content">/OpenIDLogin</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">_OpenIdInitiate</span><span class="delimiter">'</span></span>),
<span class="line-numbers">13</span>    (<span class="string"><span class="delimiter">'</span><span class="content">/OpenIDValidate</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">_OpenIdValidate</span><span class="delimiter">'</span></span>),
<span class="line-numbers">14</span>    (<span class="string"><span class="delimiter">'</span><span class="content">/ULF-Challenge</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">_ULF_Challenge</span><span class="delimiter">'</span></span>),
<span class="line-numbers">15</span>    (<span class="string"><span class="delimiter">'</span><span class="content">/ULF-Login</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">_ULF_Verify</span><span class="delimiter">'</span></span>),
<span class="line-numbers">16</span>    (<span class="string"><span class="delimiter">'</span><span class="content">/(.*)</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Index</span><span class="delimiter">'</span></span>))
<span class="line-numbers">17</span>
<span class="line-numbers">18</span>uweb3.ServerSetup()
</span></code></pre>
          <p>
            In the example above, the following things happen:
          </p>
          <ul>
            <li>
              Firstly, we import the uweb package, since we need that to configure the webserver from
            </li>
            <li>
              Secondly, we import the module where the class with our handling methods is defined (the uweb.uweb_info.pages module).
            </li>
            <li>
              PAGE_CLASS is the global that holds a reference to the PageMaker subclass for your project, from where requests are handled.
              ROUTES is the global that defines the various requests that the router understands, and directs them to the (named) method of the PAGE_CLASS.
            </li>
            <li>
              Finally, uweb.ServerSetup() starts the webserver for those cases where it runs StandAlone (and does some initial setting up for when it runs using Apache)
            </li>
          </ul>
        </div>

        <div id="routing_arguments">
          <h3>Arguments from the request string</h3>
          <p>
            Oftentimes, there are parts of the request string that are needed further on in the process.
            While it's possible to extract these in the PageMaker methods, this is inconvenient, and the router has the means to do this. 
            As can be seen in the router example above, some of the regular expressions have capture groups defined. 
            These capture groups are provided to the PageMaker method as positional arguments. 
            For example:
          </p>
          <p>
            Requesting "/user/elmer/edit/27" on the following router:
          </p>
<pre><code class="python syntaxhl"><span class="CodeRay"><span class="line-numbers">1</span>PAGE_CLASS = blog.BlogPages
<span class="line-numbers">2</span>ROUTES = (
<span class="line-numbers">3</span>    (<span class="string"><span class="delimiter">'</span><span class="content">/user/(</span><span class="content">\w</span><span class="content">*)/edit/(</span><span class="content">\d</span><span class="content">*)</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">EditArticle</span><span class="delimiter">'</span></span>),
<span class="line-numbers">4</span>    (<span class="string"><span class="delimiter">'</span><span class="content">/</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Index</span><span class="delimiter">'</span></span>))
</span></code></pre>
          <p>
            Will end up calling the method blog.BlogPages.EditArticle with the arguments ('Elmer', '27'). 
            Note that all arguments are provided as strings, type-conversion is left to the developer.
          </p>
        </div>

        <div id="routing_regex">
          <h3>Arguments from the request string</h3>
          <p>
            How to use various other url formats:
          </p>
          <ul>
            <li>
              To match one or more letters, numbers, dashes and spaces, use this: '([\w\- ]+)'
            </li>
            <li>
              Match optional trailing slashes (so that requests don't end up 404'ing because of an added slash) add: '/?'
            </li>
            <li>
              To match optional an optional page number: 'article/([\w\- ]+)/?(\d+)?'
              <ul>
                <li>
                  This matches /article/cookies_are_delicious
                </li>
                <li>
                  As well as /article/cookies_are_delicious/2
                </li>
                <li>
                  And also /article/cookies_are_delicious/ – to allow for trailing slashes that are almost certain to happen
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </section>
    </div>
  </main>
</body>
</html>